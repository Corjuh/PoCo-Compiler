PoCo Compiler
=============

Required Libraries
------------------
*   [ANTLR 4.4](http://www.antlr.org) (also be sure to get the [ANTLR plugin](https://github.com/antlr/intellij-plugin-v4)
    for IntelliJ IDEA) - for generating the lexer and parser.
*   [ASM 5.0.3](http://asm.ow2.org) (also ASM Commons 5.0.3 in the same package) - for reading compiled java bytecode
    so that we may extract method signatures.
*   [AspectJ](https://eclipse.org/aspectj/) - for use by the PoCo runtime (and code generated by compiler) to instrument
    the monitored program and its libraries.
*   [JOpt](http://pholser.github.io/jopt-simple/) - for parsing command-line options.

Command-line Options
--------------------
*   The first argument should be the PoCo policy you wish to read (e.g. `MyPolicy.poco`). The name of the file should
    match the name of the policy declared inside of it (just like with Java classes).
*   `-v` enables verbose mode (probably a good idea to use this).
*   `-o` specifies the output directory. If none is specified, the compiler will write files to the directory from
    which it is executed.
*   `-c` specifies class or jar files to scan. You can specify multiple files, each one with its own `-c` flag.

TODO
----
*   Add support for executions with alternations (they have the bar `|`).

*   Support querying and matching results of actions.

*   Add logic that converts PoCo matching strings into valid RegEx strings (this is fairly involved).

*   Add support for declaring variables and macros (and inserting them into RegEx).

*   Add support for binding variables during execution (and inserting them into RegEx during runtime).

*   Add support for suggesting alternate actions (i.e. obligations). We probably will have to use reflection to
    accomplish this.

*   *Lots* more to come :-)

Notes & Gotchas
---------------
1.  The Parser submodule contains the ANTLR grammar for the lexer and parser. The files in the `Parser/src/` directory
    are generated by ANTLR and are not kept under version control.
2.  Changes made to any of the files in `Parser/grammar/` (i.e. ANY ANTLR files) should be committed **separately** from
    other changes in the project (this makes it easier for us to merge those commits with the separate PoCo-Grammar
    repository.
3.  The files in the Runtime submodule are compiled into a jar file (see the IntelliJ IDEA project setup to see the
    *artifact* that generates it. This jar file has to be in the classpath of any instrumented program when it is run.

